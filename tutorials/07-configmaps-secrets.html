<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ConfigMaps and Secrets - Managing Configuration | Complete Guide | K8s Tutorial #7</title>
    <link rel="stylesheet" href="../styles.css">
    <link rel="stylesheet" href="../blog-styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Wider container for tutorials */
        .blog-post-detail {
            max-width: 1200px !important;
        }
        .blog-post-detail .container {
            max-width: 1200px !important;
        }
        .post-content {
            max-width: 100% !important;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar" id="navbar">
        <div class="container">
            <div class="nav-brand">
                <a href="../index.html">
                    <span class="brand-icon">‚ö°</span>
                    DevSecOpsSolution<span class="highlight">.in</span>
                </a>
            </div>
            <button class="nav-toggle" id="navToggle">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="nav-menu" id="navMenu">
                <li><a href="../index.html#home" class="nav-link">Home</a></li>
                <li><a href="../k8s-tutorials.html" class="nav-link">K8s Tutorials</a></li>
                <li><a href="../blog.html" class="nav-link">Blog</a></li>
                <li><a href="../index.html#contact" class="nav-link">Contact</a></li>
            </ul>
        </div>
    </nav>

    <!-- Blog Post Content -->
    <article class="blog-post-detail">
        <div class="container">
            <div class="post-header">
                <a href="../k8s-tutorials.html" class="back-link">
                    <i class="fas fa-arrow-left"></i> Back to Tutorials
                </a>
                <div class="post-icon">üîê</div>
                <h1 class="post-title">ConfigMaps and Secrets ‚Äî Managing Application Configuration</h1>
                <div class="post-meta">
                    <span><i class="fas fa-bookmark"></i> Tutorial #7 of 20</span>
                    <span><i class="fas fa-signal"></i> Beginner to Intermediate</span>
                    <span><i class="far fa-clock"></i> 40 min read</span>
                    <span><i class="fas fa-code"></i> Hands-On Included</span>
                </div>
            </div>
            
            <div class="post-content">

                <h3 style="color: #667eea; margin-top: 0;">üéØ What You'll Learn</h3>
                <ul style="line-height: 2;">
                    <li>Why separate configuration from application code</li>
                    <li>ConfigMaps - storing non-sensitive configuration data</li>
                    <li>Secrets - storing sensitive information securely</li>
                    <li>Different ways to create ConfigMaps and Secrets</li>
                    <li>Consuming configuration as environment variables</li>
                    <li>Mounting configuration as files (volumes)</li>
                    <li>Updating configuration without restarting pods</li>
                    <li>Secret types and encryption at rest</li>
                    <li>Best practices for configuration management</li>
                    <li>Security considerations and common pitfalls</li>
                </ul>

                <h2>ü§î The Problem: Hardcoded Configuration</h2>

                <p>Imagine you have an application that needs to connect to a database. The naive approach would be to hardcode the configuration:</p>

                <div style="background: #742a2a; color: #fed7d7; padding: 25px; border-radius: 10px; margin: 20px 0;">
                    <h4 style="color: #fca5a5; margin-top: 0;">‚ùå Bad Practice: Hardcoded Configuration</h4>
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code>// app.js - DON'T DO THIS!
const config = {
    databaseHost: 'postgres.production.svc.cluster.local',
    databasePort: 5432,
    databaseName: 'myapp',
    databaseUser: 'admin',
    databasePassword: 'SuperSecret123!',  // üò± Password in code!
    apiKey: 'sk-1234567890abcdef',        // üò± API key in code!
    environment: 'production'
};

// Now you need to:
// 1. Rebuild image for every config change
// 2. Commit secrets to Git (security risk!)
// 3. Can't reuse same image across environments
// 4. Secrets visible in image layers</code></pre>
                </div>

                <div style="background: var(--dark-light); padding: 25px; border-radius: 10px; margin: 20px 0;">
                    <h4 style="color: #90cdf4;">Problems with Hardcoded Configuration:</h4>
                    <ul style="line-height: 2;">
                        <li><strong>Security Risk:</strong> Secrets committed to version control</li>
                        <li><strong>Inflexibility:</strong> Need to rebuild image for config changes</li>
                        <li><strong>Environment Coupling:</strong> Can't use same image in dev/staging/prod</li>
                        <li><strong>Secret Exposure:</strong> Visible in container image layers</li>
                        <li><strong>No Rotation:</strong> Difficult to rotate passwords/keys</li>
                        <li><strong>Audit Trail:</strong> No tracking of who changed what</li>
                    </ul>
                </div>

                <h2>‚ú® Enter ConfigMaps and Secrets</h2>

                <p style="font-size: 1.1rem; line-height: 1.8;">Kubernetes provides two resources to externalize configuration from your application code:</p>

                <div style="background: #1c4532; color: #9ae6b4; padding: 25px; border-radius: 10px; margin: 20px 0;">
                    <h4 style="color: #9ae6b4; margin-top: 0;">‚úÖ The Kubernetes Way:</h4>
                    <ul style="line-height: 2;">
                        <li><strong>ConfigMaps:</strong> Store non-sensitive configuration data (database host, port, feature flags)</li>
                        <li><strong>Secrets:</strong> Store sensitive information (passwords, API keys, certificates)</li>
                        <li><strong>Separation:</strong> Configuration lives outside the container image</li>
                        <li><strong>Reusability:</strong> Same image works across all environments</li>
                        <li><strong>Security:</strong> Secrets are base64 encoded and can be encrypted at rest</li>
                        <li><strong>Flexibility:</strong> Update configuration without rebuilding images</li>
                    </ul>
                </div>

                <h2>üìã ConfigMaps - Non-Sensitive Configuration</h2>

                <p>ConfigMaps store configuration data as key-value pairs. Think of them as a dictionary of configuration settings.</p>

                <h3 style="color: #667eea;">What Goes in ConfigMaps?</h3>

                <div style="background: var(--dark-light); padding: 25px; border-radius: 10px; margin: 20px 0;">
                    <ul style="line-height: 2;">
                        <li>‚úÖ Database hostnames and ports</li>
                        <li>‚úÖ Application settings (log level, feature flags)</li>
                        <li>‚úÖ Configuration files (nginx.conf, application.properties)</li>
                        <li>‚úÖ Environment-specific settings</li>
                        <li>‚úÖ Command-line arguments</li>
                        <li>‚ùå Passwords, API keys, certificates (use Secrets instead!)</li>
                    </ul>
                </div>

                <h3 style="color: #667eea;">Creating ConfigMaps</h3>

                <p>There are multiple ways to create ConfigMaps:</p>

                <h4 style="color: #90cdf4;">Method 1: From Literal Values</h4>

                <div style="background: #2d3748; color: #e2e8f0; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># Create ConfigMap from literal key-value pairs
kubectl create configmap app-config \
  --from-literal=database.host=postgres.default.svc.cluster.local \
  --from-literal=database.port=5432 \
  --from-literal=log.level=info \
  --from-literal=feature.newUI=true

# Verify
kubectl get configmap app-config
kubectl describe configmap app-config</code></pre>
                </div>

                <h4 style="color: #90cdf4;">Method 2: From a File</h4>

                <div style="background: #2d3748; color: #e2e8f0; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># Create a config file
cat > app.properties << EOF
database.host=postgres.default.svc.cluster.local
database.port=5432
database.name=myapp
log.level=info
feature.newUI=true
EOF

# Create ConfigMap from file
kubectl create configmap app-config --from-file=app.properties

# The file name becomes the key, file content becomes the value
# Key: app.properties
# Value: (entire file content)</code></pre>
                </div>


                <h4 style="color: #90cdf4;">Method 3: From Multiple Files</h4>

                <div style="background: #2d3748; color: #e2e8f0; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># Create multiple config files
mkdir config
echo "server.port=8080" > config/server.properties
echo "log.level=debug" > config/logging.properties

# Create ConfigMap from directory
kubectl create configmap app-config --from-file=config/

# Each file becomes a separate key
# Keys: server.properties, logging.properties
# Values: (respective file contents)</code></pre>
                </div>

                <h4 style="color: #90cdf4;">Method 4: From YAML (Declarative)</h4>

                <div style="background: #2d3748; color: #e2e8f0; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
  namespace: default
data:
  # Simple key-value pairs
  database.host: "postgres.default.svc.cluster.local"
  database.port: "5432"
  log.level: "info"
  
  # Multi-line configuration file
  app.properties: |
    database.host=postgres.default.svc.cluster.local
    database.port=5432
    database.name=myapp
    log.level=info
    feature.newUI=true
  
  # Another configuration file
  nginx.conf: |
    server {
        listen 80;
        server_name localhost;
        location / {
            proxy_pass http://backend:8080;
        }
    }

# Apply
kubectl apply -f configmap.yaml</code></pre>
                </div>

                <h3 style="color: #667eea;">Using ConfigMaps in Pods</h3>

                <p>There are two main ways to consume ConfigMaps in your pods:</p>

                <h4 style="color: #90cdf4;">Option 1: As Environment Variables</h4>

                <div style="background: #2d3748; color: #e2e8f0; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code>apiVersion: v1
kind: Pod
metadata:
  name: app-pod
spec:
  containers:
  - name: app
    image: myapp:1.0
    
    # Method 1: Individual keys as environment variables
    env:
    - name: DATABASE_HOST
      valueFrom:
        configMapKeyRef:
          name: app-config
          key: database.host
    - name: DATABASE_PORT
      valueFrom:
        configMapKeyRef:
          name: app-config
          key: database.port
    - name: LOG_LEVEL
      valueFrom:
        configMapKeyRef:
          name: app-config
          key: log.level
    
    # Method 2: All keys as environment variables
    envFrom:
    - configMapRef:
        name: app-config
    # This creates env vars for ALL keys in the ConfigMap
    # database.host becomes DATABASE_HOST (dots replaced with underscores)</code></pre>
                </div>

                <h4 style="color: #90cdf4;">Option 2: As Volume Mounts (Files)</h4>

                <div style="background: #2d3748; color: #e2e8f0; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code>apiVersion: v1
kind: Pod
metadata:
  name: app-pod
spec:
  containers:
  - name: app
    image: myapp:1.0
    volumeMounts:
    # Mount entire ConfigMap as files
    - name: config-volume
      mountPath: /etc/config
      # Creates files:
      # /etc/config/database.host (content: postgres.default...)
      # /etc/config/database.port (content: 5432)
      # /etc/config/app.properties (content: entire file)
    
    # Mount specific keys as files
    - name: nginx-config
      mountPath: /etc/nginx/nginx.conf
      subPath: nginx.conf
      # Creates single file: /etc/nginx/nginx.conf
  
  volumes:
  - name: config-volume
    configMap:
      name: app-config
  - name: nginx-config
    configMap:
      name: app-config
      items:
      - key: nginx.conf
        path: nginx.conf</code></pre>
                </div>

                <div style="background: #1c4532; color: #9ae6b4; padding: 15px; border-radius: 5px; margin-top: 15px;">
                    <strong>üí° When to Use Each Method:</strong>
                    <ul style="margin-top: 10px;">
                        <li><strong>Environment Variables:</strong> Simple key-value configs, 12-factor apps</li>
                        <li><strong>Volume Mounts:</strong> Configuration files (nginx.conf, application.yaml), large configs</li>
                    </ul>
                </div>

                <h2>üîê Secrets - Sensitive Information</h2>

                <p>Secrets are similar to ConfigMaps but designed for sensitive data. They provide additional security features.</p>

                <h3 style="color: #667eea;">What Goes in Secrets?</h3>

                <div style="background: var(--dark-light); padding: 25px; border-radius: 10px; margin: 20px 0;">
                    <ul style="line-height: 2;">
                        <li>‚úÖ Database passwords</li>
                        <li>‚úÖ API keys and tokens</li>
                        <li>‚úÖ SSH keys</li>
                        <li>‚úÖ TLS certificates and private keys</li>
                        <li>‚úÖ OAuth tokens</li>
                        <li>‚úÖ Docker registry credentials</li>
                    </ul>
                </div>

                <h3 style="color: #667eea;">Secret Types</h3>

                <div style="background: var(--dark-light); padding: 25px; border-radius: 10px; margin: 20px 0;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #667eea; color: white;">
                                <th style="padding: 15px; text-align: left;">Type</th>
                                <th style="padding: 15px; text-align: left;">Purpose</th>
                                <th style="padding: 15px; text-align: left;">Use Case</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 15px;"><code>Opaque</code></td>
                                <td style="padding: 15px;">Generic secret (default)</td>
                                <td style="padding: 15px;">Passwords, API keys, tokens</td>
                            </tr>
                            <tr style="background: rgba(255,255,255,0.02); border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 15px;"><code>kubernetes.io/dockerconfigjson</code></td>
                                <td style="padding: 15px;">Docker registry credentials</td>
                                <td style="padding: 15px;">Pull images from private registries</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 15px;"><code>kubernetes.io/tls</code></td>
                                <td style="padding: 15px;">TLS certificate and key</td>
                                <td style="padding: 15px;">HTTPS/TLS termination</td>
                            </tr>
                            <tr style="background: rgba(255,255,255,0.02); border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 15px;"><code>kubernetes.io/ssh-auth</code></td>
                                <td style="padding: 15px;">SSH private key</td>
                                <td style="padding: 15px;">Git operations, SSH access</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 15px;"><code>kubernetes.io/basic-auth</code></td>
                                <td style="padding: 15px;">Basic authentication</td>
                                <td style="padding: 15px;">Username/password pairs</td>
                            </tr>
                            <tr style="background: rgba(255,255,255,0.02);">
                                <td style="padding: 15px;"><code>kubernetes.io/service-account-token</code></td>
                                <td style="padding: 15px;">Service account token</td>
                                <td style="padding: 15px;">Kubernetes API authentication</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3 style="color: #667eea;">Creating Secrets</h3>

                <h4 style="color: #90cdf4;">Method 1: From Literal Values</h4>

                <div style="background: #2d3748; color: #e2e8f0; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># Create generic secret
kubectl create secret generic db-secret \
  --from-literal=username=admin \
  --from-literal=password=SuperSecret123!

# Verify (values are base64 encoded)
kubectl get secret db-secret -o yaml</code></pre>
                </div>

                <h4 style="color: #90cdf4;">Method 2: From Files</h4>

                <div style="background: #2d3748; color: #e2e8f0; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># Create files with sensitive data
echo -n 'admin' > username.txt
echo -n 'SuperSecret123!' > password.txt

# Create secret from files
kubectl create secret generic db-secret \
  --from-file=username=username.txt \
  --from-file=password=password.txt

# Clean up files (important!)
rm username.txt password.txt</code></pre>
                </div>


                <h4 style="color: #90cdf4;">Method 3: From YAML (Declarative)</h4>

                <div style="background: #2d3748; color: #e2e8f0; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: db-secret
type: Opaque
data:
  # Values MUST be base64 encoded
  username: YWRtaW4=              # echo -n 'admin' | base64
  password: U3VwZXJTZWNyZXQxMjMh  # echo -n 'SuperSecret123!' | base64

# Or use stringData (Kubernetes encodes for you)
stringData:
  username: admin
  password: SuperSecret123!
  # These will be automatically base64 encoded

kubectl apply -f secret.yaml</code></pre>

                    <div style="background: #744210; color: #fed7d7; padding: 15px; border-radius: 5px; margin-top: 15px;">
                        <strong>‚ö†Ô∏è Warning:</strong> Don't commit secrets to Git! Use tools like Sealed Secrets, External Secrets Operator, or Vault for production.
                    </div>
                </div>

                <h4 style="color: #90cdf4;">Method 4: TLS Secret</h4>

                <div style="background: #2d3748; color: #e2e8f0; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># Create TLS secret from certificate and key files
kubectl create secret tls my-tls-secret \
  --cert=path/to/tls.crt \
  --key=path/to/tls.key

# Or in YAML
apiVersion: v1
kind: Secret
metadata:
  name: my-tls-secret
type: kubernetes.io/tls
data:
  tls.crt: LS0tLS1CRUdJTi... (base64 encoded certificate)
  tls.key: LS0tLS1CRUdJTi... (base64 encoded private key)</code></pre>
                </div>

                <h4 style="color: #90cdf4;">Method 5: Docker Registry Secret</h4>

                <div style="background: #2d3748; color: #e2e8f0; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># Create Docker registry secret
kubectl create secret docker-registry regcred \
  --docker-server=https://index.docker.io/v1/ \
  --docker-username=myusername \
  --docker-password=mypassword \
  --docker-email=myemail@example.com

# Use in pod
apiVersion: v1
kind: Pod
metadata:
  name: private-image-pod
spec:
  imagePullSecrets:
  - name: regcred
  containers:
  - name: app
    image: myusername/private-image:latest</code></pre>
                </div>

                <h3 style="color: #667eea;">Using Secrets in Pods</h3>

                <h4 style="color: #90cdf4;">Option 1: As Environment Variables</h4>

                <div style="background: #2d3748; color: #e2e8f0; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code>apiVersion: v1
kind: Pod
metadata:
  name: app-pod
spec:
  containers:
  - name: app
    image: myapp:1.0
    
    # Method 1: Individual secret keys
    env:
    - name: DB_USERNAME
      valueFrom:
        secretKeyRef:
          name: db-secret
          key: username
    - name: DB_PASSWORD
      valueFrom:
        secretKeyRef:
          name: db-secret
          key: password
    
    # Method 2: All keys from secret
    envFrom:
    - secretRef:
        name: db-secret
    # Creates env vars: username, password</code></pre>
                </div>

                <h4 style="color: #90cdf4;">Option 2: As Volume Mounts (Files)</h4>

                <div style="background: #2d3748; color: #e2e8f0; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code>apiVersion: v1
kind: Pod
metadata:
  name: app-pod
spec:
  containers:
  - name: app
    image: myapp:1.0
    volumeMounts:
    - name: secret-volume
      mountPath: /etc/secrets
      readOnly: true
      # Creates files:
      # /etc/secrets/username (content: admin)
      # /etc/secrets/password (content: SuperSecret123!)
  
  volumes:
  - name: secret-volume
    secret:
      secretName: db-secret
      # Optional: Set file permissions
      defaultMode: 0400  # Read-only for owner</code></pre>
                </div>

                <div style="background: #1c4532; color: #9ae6b4; padding: 15px; border-radius: 5px; margin-top: 15px;">
                    <strong>üí° Best Practice:</strong> Use volume mounts for secrets when possible. They're more secure than environment variables (not visible in <code>kubectl describe</code> or process listings).
                </div>

                <h2>üîÑ Updating ConfigMaps and Secrets</h2>

                <h3 style="color: #667eea;">Updating ConfigMaps</h3>

                <div style="background: #2d3748; color: #e2e8f0; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># Method 1: Edit directly
kubectl edit configmap app-config

# Method 2: Replace from file
kubectl create configmap app-config --from-file=app.properties --dry-run=client -o yaml | kubectl apply -f -

# Method 3: Patch specific key
kubectl patch configmap app-config -p '{"data":{"log.level":"debug"}}'</code></pre>
                </div>

                <h3 style="color: #667eea;">How Updates Affect Pods</h3>

                <div style="background: var(--dark-light); padding: 25px; border-radius: 10px; margin: 20px 0;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #667eea; color: white;">
                                <th style="padding: 15px; text-align: left;">Consumption Method</th>
                                <th style="padding: 15px; text-align: left;">Update Behavior</th>
                                <th style="padding: 15px; text-align: left;">Action Required</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 15px;"><strong>Environment Variables</strong></td>
                                <td style="padding: 15px;">‚ùå Not updated automatically</td>
                                <td style="padding: 15px;">Must restart/recreate pod</td>
                            </tr>
                            <tr style="background: rgba(255,255,255,0.02); border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 15px;"><strong>Volume Mounts</strong></td>
                                <td style="padding: 15px;">‚úÖ Updated automatically (eventually)</td>
                                <td style="padding: 15px;">App must watch for file changes</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 15px;"><strong>Volume with subPath</strong></td>
                                <td style="padding: 15px;">‚ùå Not updated automatically</td>
                                <td style="padding: 15px;">Must restart/recreate pod</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div style="background: #744210; color: #fed7d7; padding: 15px; border-radius: 5px; margin-top: 15px;">
                    <strong>‚ö†Ô∏è Important:</strong> Volume-mounted ConfigMaps/Secrets update eventually (can take up to 1 minute). Your application must watch for file changes and reload configuration.
                </div>

                <h3 style="color: #667eea;">Forcing Pod Restart After Config Update</h3>

                <div style="background: #2d3748; color: #e2e8f0; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># Method 1: Rollout restart (for Deployments)
kubectl rollout restart deployment/myapp

# Method 2: Delete pods (for Deployments, they'll be recreated)
kubectl delete pods -l app=myapp

# Method 3: Use a tool like Reloader
# https://github.com/stakater/Reloader
# Automatically restarts pods when ConfigMap/Secret changes</code></pre>
                </div>

                <h2>üîí Security Best Practices</h2>

                <div style="background: #1c4532; color: #9ae6b4; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <h3 style="color: #9ae6b4; margin-top: 0;">ConfigMap Security</h3>
                    <ol style="line-height: 2; font-size: 1.05rem;">
                        <li>‚úÖ <strong>Never store secrets in ConfigMaps</strong> - they're not encrypted</li>
                        <li>‚úÖ <strong>Use RBAC</strong> to control who can read/write ConfigMaps</li>
                        <li>‚úÖ <strong>Namespace isolation</strong> - ConfigMaps are namespace-scoped</li>
                        <li>‚úÖ <strong>Audit access</strong> - enable audit logging for ConfigMap changes</li>
                        <li>‚úÖ <strong>Version control</strong> - track ConfigMap changes in Git (except secrets!)</li>
                    </ol>

                    <h3 style="color: #9ae6b4; margin-top: 30px;">Secret Security</h3>
                    <ol style="line-height: 2; font-size: 1.05rem;">
                        <li>‚úÖ <strong>Enable encryption at rest</strong> - encrypt secrets in etcd</li>
                        <li>‚úÖ <strong>Use external secret management</strong> - Vault, AWS Secrets Manager, Azure Key Vault</li>
                        <li>‚úÖ <strong>Never commit secrets to Git</strong> - use tools like Sealed Secrets</li>
                        <li>‚úÖ <strong>Limit secret access with RBAC</strong> - principle of least privilege</li>
                        <li>‚úÖ <strong>Use volume mounts over env vars</strong> - more secure</li>
                        <li>‚úÖ <strong>Rotate secrets regularly</strong> - automate rotation when possible</li>
                        <li>‚úÖ <strong>Use specific secret types</strong> - TLS, Docker, SSH instead of Opaque</li>
                        <li>‚úÖ <strong>Monitor secret access</strong> - audit who accesses what</li>
                        <li>‚úÖ <strong>Use short-lived tokens</strong> - when possible</li>
                        <li>‚úÖ <strong>Scan for leaked secrets</strong> - use tools like git-secrets, trufflehog</li>
                    </ol>
                </div>


                <h2>üõ†Ô∏è Hands-On: Complete Example</h2>

                <p>Let's build a complete application using both ConfigMaps and Secrets.</p>

                <h3 style="color: #667eea;">Scenario: Web Application with Database</h3>

                <div style="background: #2d3748; color: #e2e8f0; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <p><strong>Step 1: Create ConfigMap for non-sensitive config</strong></p>
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># app-config.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
data:
  # Database connection settings (non-sensitive)
  database.host: "postgres.default.svc.cluster.local"
  database.port: "5432"
  database.name: "myapp"
  
  # Application settings
  log.level: "info"
  server.port: "8080"
  feature.newUI: "true"
  
  # Application configuration file
  application.yaml: |
    server:
      port: 8080
      timeout: 30s
    logging:
      level: info
      format: json
    features:
      newUI: true
      betaFeatures: false

kubectl apply -f app-config.yaml</code></pre>

                    <p><strong>Step 2: Create Secret for sensitive data</strong></p>
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># app-secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: app-secret
type: Opaque
stringData:
  # Database credentials
  database.username: "admin"
  database.password: "SuperSecret123!"
  
  # API keys
  stripe.api.key: "sk_test_1234567890"
  sendgrid.api.key: "SG.1234567890"
  
  # JWT secret
  jwt.secret: "my-super-secret-jwt-key-change-in-production"

kubectl apply -f app-secret.yaml</code></pre>

                    <p><strong>Step 3: Create Deployment using ConfigMap and Secret</strong></p>
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># app-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: myapp
spec:
  replicas: 3
  selector:
    matchLabels:
      app: myapp
  template:
    metadata:
      labels:
        app: myapp
    spec:
      containers:
      - name: app
        image: myapp:1.0
        ports:
        - containerPort: 8080
        
        # Environment variables from ConfigMap
        env:
        - name: DATABASE_HOST
          valueFrom:
            configMapKeyRef:
              name: app-config
              key: database.host
        - name: DATABASE_PORT
          valueFrom:
            configMapKeyRef:
              name: app-config
              key: database.port
        - name: DATABASE_NAME
          valueFrom:
            configMapKeyRef:
              name: app-config
              key: database.name
        - name: LOG_LEVEL
          valueFrom:
            configMapKeyRef:
              name: app-config
              key: log.level
        
        # Environment variables from Secret
        - name: DATABASE_USERNAME
          valueFrom:
            secretKeyRef:
              name: app-secret
              key: database.username
        - name: DATABASE_PASSWORD
          valueFrom:
            secretKeyRef:
              name: app-secret
              key: database.password
        - name: STRIPE_API_KEY
          valueFrom:
            secretKeyRef:
              name: app-secret
              key: stripe.api.key
        - name: JWT_SECRET
          valueFrom:
            secretKeyRef:
              name: app-secret
              key: jwt.secret
        
        # Mount ConfigMap as file
        volumeMounts:
        - name: config-volume
          mountPath: /etc/config
          readOnly: true
        
        # Mount Secret as file
        - name: secret-volume
          mountPath: /etc/secrets
          readOnly: true
        
        resources:
          requests:
            memory: "128Mi"
            cpu: "100m"
          limits:
            memory: "256Mi"
            cpu: "200m"
      
      volumes:
      - name: config-volume
        configMap:
          name: app-config
      - name: secret-volume
        secret:
          secretName: app-secret
          defaultMode: 0400

kubectl apply -f app-deployment.yaml</code></pre>

                    <p><strong>Step 4: Verify the configuration</strong></p>
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># Check if pods are running
kubectl get pods -l app=myapp

# Exec into a pod to verify
kubectl exec -it <pod-name> -- /bin/sh

# Inside the pod:
# Check environment variables
env | grep DATABASE
env | grep LOG_LEVEL

# Check mounted config files
ls -la /etc/config/
cat /etc/config/application.yaml

# Check mounted secrets (be careful!)
ls -la /etc/secrets/
# Don't cat secrets in production!

exit</code></pre>

                    <p><strong>Step 5: Update configuration</strong></p>
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># Update log level to debug
kubectl patch configmap app-config -p '{"data":{"log.level":"debug"}}'

# Restart deployment to pick up changes
kubectl rollout restart deployment/myapp

# Watch rollout
kubectl rollout status deployment/myapp</code></pre>
                </div>

                <h2>üîç Troubleshooting</h2>

                <div style="background: #742a2a; color: #fed7d7; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <h4 style="color: #fca5a5; margin-top: 0;">Issue 1: Pod Can't Find ConfigMap/Secret</h4>
                    <p><strong>Symptoms:</strong> Pod stuck in <code>CreateContainerConfigError</code></p>
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># Check if ConfigMap/Secret exists
kubectl get configmap app-config
kubectl get secret app-secret

# Check if they're in the same namespace as the pod
kubectl get configmap app-config -n <namespace>

# Describe pod to see error
kubectl describe pod <pod-name>

# Solution: Create the ConfigMap/Secret or fix the name</code></pre>
                </div>

                <div style="background: #742a2a; color: #fed7d7; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <h4 style="color: #fca5a5; margin-top: 0;">Issue 2: Secret Values Not Decoded</h4>
                    <p><strong>Symptoms:</strong> Application receives base64 encoded values</p>
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># Problem: Using 'data' instead of 'stringData'
# Wrong:
data:
  password: U3VwZXJTZWNyZXQxMjMh  # base64 encoded

# Correct:
stringData:
  password: SuperSecret123!  # plain text, Kubernetes encodes it

# Or decode in your application
# Kubernetes automatically decodes when mounting as env var or file</code></pre>
                </div>

                <div style="background: #742a2a; color: #fed7d7; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <h4 style="color: #fca5a5; margin-top: 0;">Issue 3: ConfigMap Changes Not Reflected</h4>
                    <p><strong>Symptoms:</strong> Updated ConfigMap but pod still uses old values</p>
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># If using environment variables: Must restart pod
kubectl rollout restart deployment/myapp

# If using volume mounts: Wait up to 1 minute for sync
# Or restart pod to force immediate update

# Check if ConfigMap was actually updated
kubectl get configmap app-config -o yaml</code></pre>
                </div>

                <div style="background: #742a2a; color: #fed7d7; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <h4 style="color: #fca5a5; margin-top: 0;">Issue 4: Permission Denied Reading Secret Files</h4>
                    <p><strong>Symptoms:</strong> Application can't read secret files</p>
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># Check file permissions
kubectl exec <pod-name> -- ls -la /etc/secrets/

# Solution: Set defaultMode in secret volume
volumes:
- name: secret-volume
  secret:
    secretName: app-secret
    defaultMode: 0400  # Read-only for owner

# Or run container as specific user
securityContext:
  runAsUser: 1000
  fsGroup: 1000</code></pre>
                </div>

                <h2>üéì Advanced Patterns</h2>

                <h3 style="color: #667eea;">Pattern 1: Environment-Specific ConfigMaps</h3>

                <div style="background: #2d3748; color: #e2e8f0; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># Development ConfigMap
apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
  namespace: development
data:
  database.host: "postgres.development.svc.cluster.local"
  log.level: "debug"
  feature.newUI: "true"

---
# Production ConfigMap (same name, different namespace)
apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
  namespace: production
data:
  database.host: "postgres.production.svc.cluster.local"
  log.level: "warn"
  feature.newUI: "false"

# Same deployment YAML works in both namespaces!</code></pre>
                </div>

                <h3 style="color: #667eea;">Pattern 2: Immutable ConfigMaps/Secrets</h3>

                <div style="background: #2d3748; color: #e2e8f0; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># Make ConfigMap immutable (Kubernetes 1.21+)
apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config-v1
immutable: true
data:
  database.host: "postgres.default.svc.cluster.local"

# Benefits:
# - Protects against accidental updates
# - Better performance (no watch on etcd)
# - To update: Create new ConfigMap with new name (app-config-v2)
#   and update deployment to use it</code></pre>
                </div>


                <h3 style="color: #667eea;">Pattern 3: External Secrets Operator</h3>

                <div style="background: #2d3748; color: #e2e8f0; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <pre style="background: #1a202c; padding: 15px; border-radius: 5px; overflow-x: auto;"><code># Instead of storing secrets in Kubernetes, fetch from external vault
# Example: AWS Secrets Manager
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: app-secret
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: aws-secrets-manager
    kind: SecretStore
  target:
    name: app-secret
    creationPolicy: Owner
  data:
  - secretKey: database-password
    remoteRef:
      key: prod/database/password

# This creates a Kubernetes Secret from AWS Secrets Manager
# Benefits: Centralized secret management, rotation, audit</code></pre>
                </div>

                <h2>üìä ConfigMap vs Secret Comparison</h2>

                <div style="background: var(--dark-light); padding: 25px; border-radius: 10px; margin: 20px 0;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #667eea; color: white;">
                                <th style="padding: 15px; text-align: left;">Feature</th>
                                <th style="padding: 15px; text-align: left;">ConfigMap</th>
                                <th style="padding: 15px; text-align: left;">Secret</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 15px;"><strong>Purpose</strong></td>
                                <td style="padding: 15px;">Non-sensitive configuration</td>
                                <td style="padding: 15px;">Sensitive information</td>
                            </tr>
                            <tr style="background: rgba(255,255,255,0.02); border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 15px;"><strong>Storage</strong></td>
                                <td style="padding: 15px;">Plain text in etcd</td>
                                <td style="padding: 15px;">Base64 encoded (can be encrypted)</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 15px;"><strong>Size Limit</strong></td>
                                <td style="padding: 15px;">1 MiB</td>
                                <td style="padding: 15px;">1 MiB</td>
                            </tr>
                            <tr style="background: rgba(255,255,255,0.02); border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 15px;"><strong>Visibility</strong></td>
                                <td style="padding: 15px;">Visible in kubectl describe</td>
                                <td style="padding: 15px;">Hidden in kubectl describe</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 15px;"><strong>Encryption at Rest</strong></td>
                                <td style="padding: 15px;">No</td>
                                <td style="padding: 15px;">Optional (must be configured)</td>
                            </tr>
                            <tr style="background: rgba(255,255,255,0.02); border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 15px;"><strong>RBAC</strong></td>
                                <td style="padding: 15px;">Separate permissions</td>
                                <td style="padding: 15px;">Separate permissions</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 15px;"><strong>Types</strong></td>
                                <td style="padding: 15px;">One type</td>
                                <td style="padding: 15px;">Multiple types (Opaque, TLS, Docker, etc.)</td>
                            </tr>
                            <tr style="background: rgba(255,255,255,0.02); border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 15px;"><strong>Use Cases</strong></td>
                                <td style="padding: 15px;">URLs, ports, feature flags, config files</td>
                                <td style="padding: 15px;">Passwords, API keys, certificates</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <td style="padding: 15px;"><strong>Git Storage</strong></td>
                                <td style="padding: 15px;">‚úÖ Safe to commit</td>
                                <td style="padding: 15px;">‚ùå Never commit</td>
                            </tr>
                            <tr style="background: rgba(255,255,255,0.02);">
                                <td style="padding: 15px;"><strong>Immutable</strong></td>
                                <td style="padding: 15px;">Optional (1.21+)</td>
                                <td style="padding: 15px;">Optional (1.21+)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h2>‚úÖ Best Practices Summary</h2>

                <div style="background: #1c4532; color: #9ae6b4; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <h3 style="color: #9ae6b4; margin-top: 0;">General Best Practices</h3>
                    <ol style="line-height: 2; font-size: 1.05rem;">
                        <li>‚úÖ <strong>Separate configuration from code</strong> - Never hardcode config</li>
                        <li>‚úÖ <strong>Use ConfigMaps for non-sensitive data</strong> - Database hosts, ports, settings</li>
                        <li>‚úÖ <strong>Use Secrets for sensitive data</strong> - Passwords, API keys, certificates</li>
                        <li>‚úÖ <strong>One ConfigMap/Secret per application</strong> - Or per environment</li>
                        <li>‚úÖ <strong>Use meaningful names</strong> - app-config, db-secret, not config1, secret2</li>
                        <li>‚úÖ <strong>Document your configuration</strong> - Add comments in YAML</li>
                        <li>‚úÖ <strong>Version your ConfigMaps</strong> - app-config-v1, app-config-v2</li>
                        <li>‚úÖ <strong>Use namespaces for isolation</strong> - dev, staging, prod</li>
                        <li>‚úÖ <strong>Implement RBAC</strong> - Control who can read/write configs</li>
                        <li>‚úÖ <strong>Monitor configuration changes</strong> - Enable audit logging</li>
                    </ol>

                    <h3 style="color: #9ae6b4; margin-top: 30px;">Secret-Specific Best Practices</h3>
                    <ol style="line-height: 2; font-size: 1.05rem;">
                        <li>‚úÖ <strong>Enable encryption at rest</strong> - Encrypt secrets in etcd</li>
                        <li>‚úÖ <strong>Use external secret management</strong> - Vault, AWS Secrets Manager, etc.</li>
                        <li>‚úÖ <strong>Never commit secrets to Git</strong> - Use Sealed Secrets or similar</li>
                        <li>‚úÖ <strong>Prefer volume mounts over env vars</strong> - More secure</li>
                        <li>‚úÖ <strong>Set restrictive file permissions</strong> - defaultMode: 0400</li>
                        <li>‚úÖ <strong>Rotate secrets regularly</strong> - Automate when possible</li>
                        <li>‚úÖ <strong>Use specific secret types</strong> - TLS, Docker, SSH</li>
                        <li>‚úÖ <strong>Limit secret access</strong> - RBAC with least privilege</li>
                        <li>‚úÖ <strong>Scan for leaked secrets</strong> - Use git-secrets, trufflehog</li>
                        <li>‚úÖ <strong>Audit secret access</strong> - Track who accesses what</li>
                    </ol>

                    <h3 style="color: #9ae6b4; margin-top: 30px;">Deployment Best Practices</h3>
                    <ol style="line-height: 2; font-size: 1.05rem;">
                        <li>‚úÖ <strong>Create ConfigMaps/Secrets before pods</strong> - Avoid CreateContainerConfigError</li>
                        <li>‚úÖ <strong>Use volume mounts for large configs</strong> - Better than env vars</li>
                        <li>‚úÖ <strong>Handle missing configs gracefully</strong> - App should have defaults</li>
                        <li>‚úÖ <strong>Watch for config changes</strong> - Reload without restart when possible</li>
                        <li>‚úÖ <strong>Test config changes in dev first</strong> - Never test in production</li>
                        <li>‚úÖ <strong>Use immutable ConfigMaps for stability</strong> - Create new versions</li>
                        <li>‚úÖ <strong>Document required configs</strong> - README or comments</li>
                    </ol>
                </div>

                <h2>üéØ Key Takeaways</h2>

                <div style="background: #1c4532; color: #9ae6b4; padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <ul style="line-height: 2; font-size: 1.05rem;">
                        <li>‚úÖ <strong>ConfigMaps store non-sensitive configuration</strong> - database hosts, ports, settings</li>
                        <li>‚úÖ <strong>Secrets store sensitive information</strong> - passwords, API keys, certificates</li>
                        <li>‚úÖ <strong>Both decouple configuration from code</strong> - same image works everywhere</li>
                        <li>‚úÖ <strong>Multiple ways to create</strong> - literals, files, YAML</li>
                        <li>‚úÖ <strong>Two consumption methods</strong> - environment variables or volume mounts</li>
                        <li>‚úÖ <strong>Volume mounts update automatically</strong> - env vars require pod restart</li>
                        <li>‚úÖ <strong>Secrets are base64 encoded</strong> - not encrypted by default</li>
                        <li>‚úÖ <strong>Enable encryption at rest</strong> - for production secrets</li>
                        <li>‚úÖ <strong>Use external secret management</strong> - Vault, AWS Secrets Manager</li>
                        <li>‚úÖ <strong>Never commit secrets to Git</strong> - use Sealed Secrets or similar tools</li>
                    </ul>
                </div>

                <h2>üöÄ What's Next?</h2>

                <div style="background: var(--dark-light); padding: 25px; border-radius: 10px; margin: 30px 0;">
                    <p style="font-size: 1.1rem; line-height: 1.8;">Now that you understand configuration management, you're ready to explore:</p>
                    <ul style="line-height: 2; font-size: 1.05rem;">
                        <li><strong>Tutorial #8: Persistent Storage</strong> - Volumes, PVs, and PVCs</li>
                        <li><strong>Tutorial #9: Namespaces</strong> - Resource isolation and organization</li>
                        <li><strong>Tutorial #10: StatefulSets</strong> - Stateful applications</li>
                        <li><strong>Tutorial #11: Ingress</strong> - External access to services</li>
                        <li><strong>Tutorial #12: Security</strong> - RBAC, Pod Security, Network Policies</li>
                    </ul>
                </div>

                <div style="background: #2d3748; color: #e2e8f0; padding: 25px; border-radius: 10px; margin: 30px 0; text-align: center;">
                    <h3 style="color: #90cdf4; margin-top: 0;">üéì Practice Exercise</h3>
                    <p style="font-size: 1.1rem; line-height: 1.8;">Try this hands-on exercise:</p>
                    <ol style="text-align: left; line-height: 2; font-size: 1.05rem;">
                        <li>Create a ConfigMap with database connection settings</li>
                        <li>Create a Secret with database credentials</li>
                        <li>Deploy an application that uses both</li>
                        <li>Update the ConfigMap and observe the behavior</li>
                        <li>Implement automatic pod restart on config change (using Reloader)</li>
                        <li>Try mounting configs as both env vars and files</li>
                    </ol>
                </div>

            </div>

            <!-- Navigation -->
            <div style="display: flex; justify-content: space-between; margin-top: 50px; padding-top: 30px; border-top: 2px solid rgba(255,255,255,0.1);">
                <a href="06-services.html" style="color: #667eea; text-decoration: none; font-size: 1.1rem;">
                    ‚Üê Previous: Services
                </a>
                <a href="../k8s-tutorials.html" style="color: #667eea; text-decoration: none; font-size: 1.1rem;">
                    Back to Tutorials
                </a>
                <a href="08-persistent-storage.html" style="color: #667eea; text-decoration: none; font-size: 1.1rem;">
                    Next: Persistent Storage ‚Üí
                </a>
            </div>
        </div>
    </article>

    <!-- Footer -->
    <footer style="background: var(--dark-light); padding: 40px 0; margin-top: 80px;">
        <div class="container" style="text-align: center;">
            <p style="color: rgba(255,255,255,0.6); margin: 0;">
                ¬© 2024 DevSecOpsSolution.in | Kubernetes Tutorial Series
            </p>
            <p style="color: rgba(255,255,255,0.4); margin: 10px 0 0 0; font-size: 0.9rem;">
                Master Kubernetes, one tutorial at a time
            </p>
        </div>
    </footer>

    <script src="../script.js"></script>
    <script src="../blog-post.js"></script>
</body>
</html>
